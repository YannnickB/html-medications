/* Copyright (C) Volcanomobile, Inc - All Rights Reserved
 * Unauthorized copying of this file, via any medium is strictly prohibited
 * Proprietary and confidential 
 * Written by Volcanomobile <contact@volcanomobile.net>, January 2020 
 */ 

$.fn.fill=function(values,click){var element=$(this);element.each(function(){if($(this).attr("disabled")){element.fillDisable()}});
var entries=Object.entries(values);for(var i=0;i<entries.length;i++){var key=entries[i][0];var value=entries[i][1];if(Array.isArray(value)){element.find("."+key).html(JSON.stringify(value))
}else{element.find("."+key).not("a").not("input").not("select").not(".clickable").html(value);element.find("[fill-key="+key+"]").not("a").not("input").not("select").not(".clickable").not("[fill-type]").html(value);
element.find("."+key+"_on").css("display",value?"":"none");element.find("."+key+"_off").css("display",value?"none":"")}}var entries=Object.entries(values);
for(var i=0;i<entries.length;i++){var key=entries[i][0];var value=entries[i][1];element.find("img."+key+"").attr("src",value)}element.find(":input[fill-name]").each(function(){var fillName=$(this).attr("fill-name");
fillName=fillName.replace("[[index]]","["+element.attr("fill-list-index")+"]");var entries=Object.entries(values);for(var i=0;i<entries.length;
i++){fillName=fillName.replace("[["+entries[i][0]+"]]","["+entries[i][1]+"]")}$(this).attr("name",fillName)});var entries=Object.entries(values);
for(var i=0;i<entries.length;i++){var key=entries[i][0];var value=entries[i][1];element.find("[name="+key+"]").val(value);element.find("input:checkbox[name="+key+"]").prop("checked",value?true:false);
element.find(":input[fill-key="+key+"]").val(value);element.find("input:checkbox[fill-key="+key+"]").prop("checked",value?true:false)
}var entries=Object.entries(values);for(var i=0;i<entries.length;i++){var key=entries[i][0];var value=entries[i][1];element.find("input[name="+key+"][type='image']").attr("src",value)
}var entries=Object.entries(values);for(var i=0;i<entries.length;i++){var key=entries[i][0];var value=entries[i][1];element.find("."+key+"[fill-type=backgroundColor]").css("background-color",value);
element.find("[fill-key="+key+"][fill-type=backgroundColor]").css("background-color",value)}var entries=Object.entries(values);for(var i=0;
i<entries.length;i++){var key=entries[i][0];var value=entries[i][1];if(value){element.find("[fill-key="+key+"][fill-type=backgroundImage]").css("background-image","url('"+value+"')")
}}var entries=Object.entries(values);for(var i=0;i<entries.length;i++){var key=entries[i][0];var value=entries[i][1];element.find("a."+key).add(element.filter("a."+key)).attr("href",value);
element.find("a[fill-key="+key+"]").add(element.filter("a[fill-key="+key+"]")).attr("href",value)}var entries=Object.entries(values);
for(var i=0;i<entries.length;i++){var key=entries[i][0];var value=entries[i][1];element.find(".clickable."+key).attr("fill-item-id",value);
element.find(".clickable[fill-key="+key+"]").attr("fill-item-id",value)}element.find(".clickable").off("click").on("click",function(){if(click){click($(this).attr("fill-click-action"),$(this).attr("fill-item-id"))
}return false})};$.fn.fillAjax=function(url,clickFunc,successFunc,errorFunc){var element=$(this);element.fillReset();$.ajax({type:"GET",url:url,content:"application/json",success:function(data){element.fill(data,clickFunc);
if(successFunc){successFunc(element,data)}},error:function(jqXHR,textStatus,errorThrown){console.error("ERROR fillAjax() jqXHR="+JSON.stringify(jqXHR)+", textStatus="+textStatus+", errorThrown="+errorThrown);
if(errorFunc){errorFunc(jqXHR,textStatus,errorThrown,element,url)}}})};$.fn.fillInputSelect=function(options){$(this).html("");for(var i=0;i<options.length;i++){var option=options[i];var optionElem=$("<option>",{value:option.value}).html(option.label?option.label:option.value);
if(option.selected){optionElem.attr("selected","selected")}$(this).append(optionElem)}};$.fn.fillInputsSelect=function(optionsList){for(var i=0;
i<optionsList.length;i++){var inputName=optionsList[i]["name"];$(this).find("select[name="+inputName+"]").fillInputSelect(optionsList[i]["options"]);
$(this).find("select[fill-key="+inputName+"]").fillInputSelect(optionsList[i]["options"])}};$.fn.fillInputsSelectAjax=function(url,success,error){var element=$(this);
$.ajax({type:"GET",url:url,content:"application/json",success:function(data){element.fillInputsSelect(data);if(success){success(data)
}},error:function(data,textStatus){console.log("ERROR "+data+", textStatus="+textStatus);if(error){error(data,textStatus)}}})};$.fn.fillList=function(values,editHref,click){var itemTemplateId=$(this).attr("fill-items-template");var itemTemplate=itemTemplateId?$("#"+itemTemplateId):null;
var theadTmp=$(this).find(".fillListTop");if(!theadTmp.length){var panel=$("<div>",{"class":"fillListTop",style:"display: flex;"});
panel.append($("<div>",{style:"flex: 1;"}));panel.append($("<div>",{"class":"fillListCount"}).html(values.values.length+" results"));
$(this).prepend(panel)}if(itemTemplate){var itemsContainer=$(this).find(".fillListItemsContainer");if(!itemsContainer.length){itemsContainer=$("<div>",{"class":"fillListItemsContainer"})
}itemsContainer.html("");var rowEntries=Object.entries(values.values);for(var i=0;i<rowEntries.length;i++){var rowEntry=rowEntries[i][1];
var rowEditHref=editHref;var columnsEntries=Object.entries(rowEntry);for(var colIndex=0;colIndex<columnsEntries.length;colIndex++){var columnName=columnsEntries[colIndex][0];
var columnValue=columnsEntries[colIndex][1];rowEditHref=rowEditHref.replace("["+columnName+"]",columnValue)}rowEntry.fillEditLink=rowEditHref;
var layout=itemTemplate.clone();var layout=layout.attr("id",null);var layout=layout.attr("fill-list-index",i);layout.fill(rowEntry,function(action,id){if(click){click(action,id)
}});itemsContainer.append(layout)}$(this).append(itemsContainer)}else{$(this).fillListNoItemTemplate(values,editHref)}};$.fn.fillListNoItemTemplate=function(values,editHref){var thead=$("<thead>");
var tbody=$("<tbody>");var tfoot=$("<tfoot>");var table=$(this).find("table");if(table.length){var theadTmp=table.find("thead");if(theadTmp.length){thead=theadTmp
}else{table.append(thead)}var tbodyTmp=table.find("tbody");if(tbodyTmp.length){tbody=tbodyTmp}else{table.append(tbody)}var tfootTmp=table.find("tfoot");
if(tfootTmp.length){tfoot=tfootTmp}else{table.append(tfoot)}}else{table=$("<table>",{border:"1"});table.append(thead);table.append(tbody);
table.append(tfoot);$(this).append(table)}thead.html("");tbody.html("");tfoot.html("");for(var headerIndex=0;headerIndex<values.headers.length;
headerIndex++){var header=values.headers[headerIndex];var row=$("<tr>");for(var colIndex=0;colIndex<header.length;colIndex++){var column=header[colIndex];
row.append($("<th>",{"class":"text-bg-light"}).html(column.label))}row.append($("<th>",{"class":"text-bg-light",style:"width: 0px;"}));
thead.append(row)}var rowEntries=Object.entries(values.values);for(var i=0;i<rowEntries.length;i++){var rowEntry=rowEntries[i][1];
var row=$("<tr>");var rowEditHref=editHref;var columnsEntries=Object.entries(rowEntry);for(var colIndex=0;colIndex<columnsEntries.length;
colIndex++){var columnName=columnsEntries[colIndex][0];var columnValue=columnsEntries[colIndex][1];var displayType=null;var columnSettings=values.fields[columnName];
if(columnSettings){displayType=columnSettings.displayType}var cellContent=columnValue;if(displayType=="image"){if(columnValue){cellContent=$("<img/>",{src:columnValue,style:"height: 2em;"})
}}else{if(displayType=="color"){cellContent=$("<span/>",{style:"display: inline-block; width: 1em; height: 1em; background-color: "+columnValue+";"})
}}row.append($("<td>",{title:columnName}).html(cellContent));rowEditHref=rowEditHref.replace("["+columnName+"]",columnValue)}row.append($("<td>",{"class":"text-center"}).html($("<a>",{href:rowEditHref}).html("<i class='fa fa-arrow-right'></i>")));
tbody.append(row)}var row=$("<tr>");for(var colIndex=0;colIndex<values.footer.length;colIndex++){var column=values.footer[colIndex];
if(column.type=="count"){text=values.values.length+" results"}row.append($("<th>",{colspan:column.colspan,"class":"text-bg-light text-nowrap"}).html(text))
}tfoot.append(row)};$.fn.fillListAjax=function(url,editHref,click,success,error){var element=$(this);$.ajax({type:"GET",url:url,content:"application/json",success:function(data){element.fillList(data,editHref,click);
if(success){success(element,data)}},error:function(data,textStatus){console.log("ERROR fillListAjax() data="+data+", responseText="+textStatus);
if(error){error(element,data,url)}}})};$.fn.fillReset=function(){$(this).find("form").add($(this).filter("form")).trigger("reset");$(this).find("form textarea").html("");
$(this).find("[fill-key]").not("a").not(".clickable").not("[fill-type]").html("");$(this).find("[fill-key][fill-type=backgroundImage]").css("background-image","")
};$.fn.fillDisable=function(){var element=$(this);element.find(":input").prop("disabled",true)};$.fn.fillEnable=function(){var element=$(this);
element.find(":input").prop("disabled",false)};